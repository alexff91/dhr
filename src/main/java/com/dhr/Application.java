package com.dhr;

import com.dhr.model.Company;
import com.dhr.model.Role;
import com.dhr.model.User;
import com.dhr.model.enums.RoleName;
import com.dhr.services.CompanyService;
import com.dhr.services.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.event.ApplicationReadyEvent;
import org.springframework.context.event.EventListener;

import java.util.Collections;

@SpringBootApplication
public class Application {
    @Autowired
    UserService userService;

    @Autowired
    CompanyService companyService;

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

    @EventListener(ApplicationReadyEvent.class)
    void initAdminUser() {
        User admin = userService.getByLogin("admin");
        if (admin == null) {
            Company company = companyService.save(Company.builder().name("NEXIGN")
                    .description("Nexign (ранее «Петер-Сервис») — первый и крупнейший разработчик биллинговых систем для крупнейших операторов связи. Сегодня ПО, созданное в компании, обслуживает более 200 млн абонентов в России и 14 странах мира. Продукты соответствуют высоким стандартам, что позволяет расширить присутствие на международном рынке, поэтому с 2018 года компания работает под брендом Nexign.")
                    .logo("data:image/jpeg;base64,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")
                    .build());
            User adminUser = User.builder()
                    .roles(Collections.singletonList(
                            Role.builder()
                                    .name(RoleName.ADMIN)
                                    .build()))
                    .company(company).login("admin").password("admin123").build();
            userService.save(company.getId(), adminUser);
        }
    }
}
